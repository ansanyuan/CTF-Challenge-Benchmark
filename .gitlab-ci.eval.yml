variables:
  TAG_NAME: latest  # 默认值
evaluate:
  stage: evaluate
  image: "docker.cat/gitlab/ccb:$TAG_NAME"
  variables:
    TAG_NAME: ${CI_COMMIT_SHORT_SHA}  # 如果 CI_COMMIT_SHORT_SHA 有值，会覆盖外层的 'latest'
    MODEL_NAME: "HIVE0-36B-1029-sft"
    API_KEY: "meow"
    DATASETS_PATH: "rewards"
    BASE_URL: "http://100.64.8.2:8000/v1"
  script:
    - ccb --datasets-path $DATASETS_PATH --model-name $MODEL_NAME --api-key $API_KEY --base-url $BASE_URL
  artifacts:
    paths:
      - dump.json
      - stress_test_report.json