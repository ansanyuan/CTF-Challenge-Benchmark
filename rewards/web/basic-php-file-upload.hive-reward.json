{
    "topic": "分析如下代码，找出漏洞被利用,服务器环境为：linux apache php\n<?php\n$is_upload = false;\n$msg = null;\nif (isset($_POST['submit'])) {\n    if (file_exists(UPLOAD_PATH)) {\n        $deny_ext = array(\".php\", \".php5\", \".php4\", \".php3\", \".php2\", \"php1\", \".html\", \".htm\", \".phtml\", \".pht\", \".pHp\", \".pHp5\", \".pHp4\", \".pHp3\", \".pHp2\", \"pHp1\", \".Html\", \".Htm\", \".pHtml\", \".jsp\", \".jspa\", \".jspx\", \".jsw\", \".jsv\", \".jspf\", \".jtml\", \".jSp\", \".jSpx\", \".jSpa\", \".jSw\", \".jSv\", \".jSpf\", \".jHtml\", \".asp\", \".aspx\", \".asa\", \".asax\", \".ascx\", \".ashx\", \".asmx\", \".cer\", \".aSp\", \".aSpx\", \".aSa\", \".aSax\", \".aScx\", \".aShx\", \".aSmx\", \".cEr\", \".sWf\", \".swf\");\n        $file_name = trim($_FILES['upload_file']['name']);\n        $file_name = deldot($file_name);\n        $file_ext = strrchr($file_name, '.');\n        $file_ext = strtolower($file_ext);\n        $file_ext = str_ireplace('::$DATA', '', $file_ext);//去除字符串::$DATA\n        $file_ext = trim($file_ext);\n        if (!in_array($file_ext, $deny_ext)) {\n            $temp_file = $_FILES['upload_file']['tmp_name'];\n            $img_path = UPLOAD_PATH . '/' . date(\"YmdHis\") . rand(1000, 9999) . $file_ext;\n            if (move_uploaded_file($temp_file, $img_path)) {\n                $is_upload = true;\n            } else {\n                $msg = '上传出错！';\n            }\n        } else {\n            $msg = '此文件不允许上传!';\n        }\n    } else {\n        $msg = UPLOAD_PATH . '文件夹不存在,请手工创建！';\n    }\n}\n?>",
    "checkpoint": [
      {
        ".htaccess": 0.3
      },
      {
        "AddType application/x-httpd-php": 0.4
      },
      {
        "FilesMatch": 0.3
      }
    ],
    "matchingmethod": [
      "normal",
      "normal",
      "normal"
    ]
  }