 {
  "topic": "获得hint.php的内容\n<?php\n// php版本:5.4.44\nheader(\"Content-type: text/html; charset=utf-8\");\nhighlight_file(__FILE__);\n\nclass evil{\n    public $hint;\n\n    public function __construct($hint){\n        $this->hint = $hint;\n    }\n\n    public function __destruct(){\n    if($this->hint===\"hint.php\")\n            @$this->hint = base64_encode(file_get_contents($this->hint)); \n        var_dump($this->hint);\n    }\n\n    function __wakeup() { \n        if ($this->hint != \"╭(●｀∀´●)╯\") { \n            //There's a hint in ./hint.php\n            $this->hint = \"╰(●’◡’●)╮\"; \n        } \n    }\n}\n\nclass User\n{\n    public $username;\n    public $password;\n\n    public function __construct($username, $password){\n        $this->username = $username;\n        $this->password = $password;\n    }\n\n}\n\nfunction write($data){\n    global $tmp;\n    $data = str_replace(chr(0).'*'.chr(0), '\\0\\0\\0', $data);\n    $tmp = $data;\n}\n\nfunction read(){\n    global $tmp;\n    $data = $tmp;\n    $r = str_replace('\\0\\0\\0', chr(0).'*'.chr(0), $data);\n    return $r;\n}\n\n$tmp = \"test\";\n$username = $_POST['username'];\n$password = $_POST['password'];\n\n$a = serialize(new User($username, $password));\nif(preg_match('/flag/is',$a))\n    die(\"NoNoNo!\");\n\nunserialize(read(write($a)));\n",
  "checkpoint": [
    {
      "反序列化|unserialize": 0.2
    },
    {
      "__wakeup": 0.1
    },
    {
      "O:4:\"evil\":2:{s:4:\"hint\";s:8:\"hint.php\";}": 0.3
    },
    {
      "\\0": 0.4
    }
  ],
  "matchingmethod": [
    "regex",
    "normal",
    "normal",
    "normal"
  ]
}